<div class="position-sticky" style="top: 5rem;">
    <nav class="nav flex-column nav-pills left-sidebar-nav">
        <a class="nav-link {% if request.endpoint == 'community.board_index' %}active{% endif %}" href="{{ url_for('community.board_index') }}">
            <i class="bi bi-house-door-fill me-2"></i> ホーム
        </a>
        <a class="nav-link {% if request.endpoint == 'auth.mypage' %}active{% endif %}" href="{{ url_for('auth.mypage') }}">
            <i class="bi bi-person-fill me-2"></i> マイページ
        </a>
        <a class="nav-link" href="#" id="notification-nav-link" data-bs-toggle="dropdown" aria-expanded="false">
            <i class="bi bi-bell-fill me-2"></i> 通知
        </a>
        <a class="nav-link {% if request.blueprint == 'dm' %}active{% endif %}" href="{{ url_for('dm.inbox') }}">
            <i class="bi bi-envelope-fill me-2"></i> DM
        </a>
        <a class="nav-link {% if request.endpoint == 'community.bookmarks' %}active{% endif %}" href="{{ url_for('community.bookmarks') }}">
            <i class="bi bi-bookmark-fill me-2"></i> ブックマーク
        </a>

        {% set mode = current_mode|default('normal') %}
        {% set feed = current_feed|default(None) %}
        {% set category = selected_category|default(None) %}
        {% set q = search_query|default(None) %}
        {% if mode == 'anonymous' %}
            <a class="nav-link" href="{{ url_for('community.board_index', mode='normal', feed=feed, category=category, q=q) }}">
                <i class="bi bi-person-check-fill me-2"></i> 通常モードへ
            </a>
        {% else %}
            <a class="nav-link" href="{{ url_for('community.board_index', mode='anonymous', feed=feed, category=category, q=q) }}">
                <i class="bi bi-person-fill-slash me-2"></i> 匿名モードへ
            </a>
        {% endif %}

        {% if current_user.is_authenticated %}
            <a class="nav-link {% if request.endpoint == 'community.drafts' %}active{% endif %}" href="{{ url_for('community.drafts') }}">
                <i class="bi bi-archive-fill me-2"></i> 下書き一覧
            </a>
        {% endif %}

        <a class="nav-link {% if request.endpoint == 'community.community_settings' %}active{% endif %}" href="{{ url_for('community.community_settings') }}">
            <i class="bi bi-gear-fill me-2"></i> 設定
        </a>
        <div class="mt-3 d-grid">
            <button type="button" class="btn btn-primary modal-trigger-btn"
                    data-bs-toggle="modal" data-bs-target="#mainModal"
                    data-url="{{ url_for('community.new_post') }}"
                    data-title="新しい投稿">
                投稿する
            </button>
        </div>
    </nav>
</div>
